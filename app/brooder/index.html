<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<!-- Meta, title, CSS, favicons, etc. -->
		<meta charset="utf-8">	
	</head>
	<body>
	<br>
	<button onclick="on()">Turn On</button>
	<br>
	<br>
	<button onclick="off()">Turn Off</button>
	
	<script src="js/jquery-3.3.1.min.js"></script>	
	<script src="js/mqttws31.min.js"></script>
	<script type="text/javascript">
	
		$(function() {

			client = new Paho.MQTT.Client("192.168.10.1", 1884, "");
			
			// set callback handlers
			client.onConnectionLost = onConnectionLost;
			client.onMessageArrived = onMessageArrived;

			// connect the client
			client.connect({onSuccess:onConnect});

			// called when the client connects
			function onConnect() {
			  // Once a connection has been made, make a subscription and send a message.
			  console.log("onConnect");
			  client.subscribe("ledStatus");
			  // message = new Paho.MQTT.Message("0");
			  // message.destinationName = "ledCommand";
			  // client.send(message);
			}

			// called when the client loses its connection
			function onConnectionLost(responseObject) {
			  if (responseObject.errorCode !== 0) {
				console.log("onConnectionLost:"+responseObject.errorMessage);
			  }
			}

			// called when a message arrives
			function onMessageArrived(message) {
			  console.log(JSON.parse(message.payloadString));
			}
		
		});
	
		function on() {
			
			message = new Paho.MQTT.Message("1");
			message.destinationName = "ledCommand";
			client.send(message);
			
		}

		function off() {
			
			message = new Paho.MQTT.Message("0");
			message.destinationName = "ledCommand";
			client.send(message);
			
		}		
	
	</script>
	</body>	
</html>
